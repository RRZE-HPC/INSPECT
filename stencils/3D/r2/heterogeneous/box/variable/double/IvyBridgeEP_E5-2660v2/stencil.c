double a[M][N][P];
double b[M][N][P];
double W[125][M][N][P];

for(long k=2; k < M-2; ++k){
for(long j=2; j < N-2; ++j){
for(long i=2; i < P-2; ++i){
b[k][j][i] = W[0][k][j][i] * a[k][j][i]
+ W[1][k][j][i] * a[k-2][j-2][i-2]
+ W[2][k][j][i] * a[k-1][j-2][i-2]
+ W[3][k][j][i] * a[k][j-2][i-2]
+ W[4][k][j][i] * a[k+1][j-2][i-2]
+ W[5][k][j][i] * a[k+2][j-2][i-2]
+ W[6][k][j][i] * a[k-2][j-1][i-2]
+ W[7][k][j][i] * a[k-1][j-1][i-2]
+ W[8][k][j][i] * a[k][j-1][i-2]
+ W[9][k][j][i] * a[k+1][j-1][i-2]
+ W[10][k][j][i] * a[k+2][j-1][i-2]
+ W[11][k][j][i] * a[k-2][j][i-2]
+ W[12][k][j][i] * a[k-1][j][i-2]
+ W[13][k][j][i] * a[k][j][i-2]
+ W[14][k][j][i] * a[k+1][j][i-2]
+ W[15][k][j][i] * a[k+2][j][i-2]
+ W[16][k][j][i] * a[k-2][j+1][i-2]
+ W[17][k][j][i] * a[k-1][j+1][i-2]
+ W[18][k][j][i] * a[k][j+1][i-2]
+ W[19][k][j][i] * a[k+1][j+1][i-2]
+ W[20][k][j][i] * a[k+2][j+1][i-2]
+ W[21][k][j][i] * a[k-2][j+2][i-2]
+ W[22][k][j][i] * a[k-1][j+2][i-2]
+ W[23][k][j][i] * a[k][j+2][i-2]
+ W[24][k][j][i] * a[k+1][j+2][i-2]
+ W[25][k][j][i] * a[k+2][j+2][i-2]
+ W[26][k][j][i] * a[k-2][j-2][i-1]
+ W[27][k][j][i] * a[k-1][j-2][i-1]
+ W[28][k][j][i] * a[k][j-2][i-1]
+ W[29][k][j][i] * a[k+1][j-2][i-1]
+ W[30][k][j][i] * a[k+2][j-2][i-1]
+ W[31][k][j][i] * a[k-2][j-1][i-1]
+ W[32][k][j][i] * a[k-1][j-1][i-1]
+ W[33][k][j][i] * a[k][j-1][i-1]
+ W[34][k][j][i] * a[k+1][j-1][i-1]
+ W[35][k][j][i] * a[k+2][j-1][i-1]
+ W[36][k][j][i] * a[k-2][j][i-1]
+ W[37][k][j][i] * a[k-1][j][i-1]
+ W[38][k][j][i] * a[k][j][i-1]
+ W[39][k][j][i] * a[k+1][j][i-1]
+ W[40][k][j][i] * a[k+2][j][i-1]
+ W[41][k][j][i] * a[k-2][j+1][i-1]
+ W[42][k][j][i] * a[k-1][j+1][i-1]
+ W[43][k][j][i] * a[k][j+1][i-1]
+ W[44][k][j][i] * a[k+1][j+1][i-1]
+ W[45][k][j][i] * a[k+2][j+1][i-1]
+ W[46][k][j][i] * a[k-2][j+2][i-1]
+ W[47][k][j][i] * a[k-1][j+2][i-1]
+ W[48][k][j][i] * a[k][j+2][i-1]
+ W[49][k][j][i] * a[k+1][j+2][i-1]
+ W[50][k][j][i] * a[k+2][j+2][i-1]
+ W[51][k][j][i] * a[k-2][j-2][i]
+ W[52][k][j][i] * a[k-1][j-2][i]
+ W[53][k][j][i] * a[k][j-2][i]
+ W[54][k][j][i] * a[k+1][j-2][i]
+ W[55][k][j][i] * a[k+2][j-2][i]
+ W[56][k][j][i] * a[k-2][j-1][i]
+ W[57][k][j][i] * a[k-1][j-1][i]
+ W[58][k][j][i] * a[k][j-1][i]
+ W[59][k][j][i] * a[k+1][j-1][i]
+ W[60][k][j][i] * a[k+2][j-1][i]
+ W[61][k][j][i] * a[k-2][j][i]
+ W[62][k][j][i] * a[k-1][j][i]
+ W[63][k][j][i] * a[k+1][j][i]
+ W[64][k][j][i] * a[k+2][j][i]
+ W[65][k][j][i] * a[k-2][j+1][i]
+ W[66][k][j][i] * a[k-1][j+1][i]
+ W[67][k][j][i] * a[k][j+1][i]
+ W[68][k][j][i] * a[k+1][j+1][i]
+ W[69][k][j][i] * a[k+2][j+1][i]
+ W[70][k][j][i] * a[k-2][j+2][i]
+ W[71][k][j][i] * a[k-1][j+2][i]
+ W[72][k][j][i] * a[k][j+2][i]
+ W[73][k][j][i] * a[k+1][j+2][i]
+ W[74][k][j][i] * a[k+2][j+2][i]
+ W[75][k][j][i] * a[k-2][j-2][i+1]
+ W[76][k][j][i] * a[k-1][j-2][i+1]
+ W[77][k][j][i] * a[k][j-2][i+1]
+ W[78][k][j][i] * a[k+1][j-2][i+1]
+ W[79][k][j][i] * a[k+2][j-2][i+1]
+ W[80][k][j][i] * a[k-2][j-1][i+1]
+ W[81][k][j][i] * a[k-1][j-1][i+1]
+ W[82][k][j][i] * a[k][j-1][i+1]
+ W[83][k][j][i] * a[k+1][j-1][i+1]
+ W[84][k][j][i] * a[k+2][j-1][i+1]
+ W[85][k][j][i] * a[k-2][j][i+1]
+ W[86][k][j][i] * a[k-1][j][i+1]
+ W[87][k][j][i] * a[k][j][i+1]
+ W[88][k][j][i] * a[k+1][j][i+1]
+ W[89][k][j][i] * a[k+2][j][i+1]
+ W[90][k][j][i] * a[k-2][j+1][i+1]
+ W[91][k][j][i] * a[k-1][j+1][i+1]
+ W[92][k][j][i] * a[k][j+1][i+1]
+ W[93][k][j][i] * a[k+1][j+1][i+1]
+ W[94][k][j][i] * a[k+2][j+1][i+1]
+ W[95][k][j][i] * a[k-2][j+2][i+1]
+ W[96][k][j][i] * a[k-1][j+2][i+1]
+ W[97][k][j][i] * a[k][j+2][i+1]
+ W[98][k][j][i] * a[k+1][j+2][i+1]
+ W[99][k][j][i] * a[k+2][j+2][i+1]
+ W[100][k][j][i] * a[k-2][j-2][i+2]
+ W[101][k][j][i] * a[k-1][j-2][i+2]
+ W[102][k][j][i] * a[k][j-2][i+2]
+ W[103][k][j][i] * a[k+1][j-2][i+2]
+ W[104][k][j][i] * a[k+2][j-2][i+2]
+ W[105][k][j][i] * a[k-2][j-1][i+2]
+ W[106][k][j][i] * a[k-1][j-1][i+2]
+ W[107][k][j][i] * a[k][j-1][i+2]
+ W[108][k][j][i] * a[k+1][j-1][i+2]
+ W[109][k][j][i] * a[k+2][j-1][i+2]
+ W[110][k][j][i] * a[k-2][j][i+2]
+ W[111][k][j][i] * a[k-1][j][i+2]
+ W[112][k][j][i] * a[k][j][i+2]
+ W[113][k][j][i] * a[k+1][j][i+2]
+ W[114][k][j][i] * a[k+2][j][i+2]
+ W[115][k][j][i] * a[k-2][j+1][i+2]
+ W[116][k][j][i] * a[k-1][j+1][i+2]
+ W[117][k][j][i] * a[k][j+1][i+2]
+ W[118][k][j][i] * a[k+1][j+1][i+2]
+ W[119][k][j][i] * a[k+2][j+1][i+2]
+ W[120][k][j][i] * a[k-2][j+2][i+2]
+ W[121][k][j][i] * a[k-1][j+2][i+2]
+ W[122][k][j][i] * a[k][j+2][i+2]
+ W[123][k][j][i] * a[k+1][j+2][i+2]
+ W[124][k][j][i] * a[k+2][j+2][i+2]
;
}
}
}
